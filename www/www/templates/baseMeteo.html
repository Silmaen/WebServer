{% load static template_extra %}
<html lang="fr">
<head>
    <title>{% block title %}Site de Lachouette{% endblock %}</title>
    <meta charset="UTF-8">
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="robots" content="index,follow">
    <meta name="author" content="Argawaen">
    <meta name="description" content="le contenu">
    <link rel="shortcut icon" href="{% static 'img/favicon.ico' %}"/>
    <meta name="keywords" content="FUCK!!">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <!-- feuille de style -->
    <link rel="stylesheet" href="{% static 'css/default.css' %}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    <script src="{% static 'js/chartutils.js' %}"></script>
</head>
<body>
<header class="site-header"> <!-- conteneur global de l'entÃªte -->
    <div class="upper-header" role="banner">
        <div class="site-title">
            <a href="/" title="super site"><img alt="Accueil" src="{% static 'img/test.png' %}" width="90" height="90"></a>
            <h3 class="noprint">La crypte de Lachouette</h3>
        </div><!-- class="site-title" -->
        <div class="site-topright">
            <div class="site-user">
                {% if user.is_authenticated %}
                <div class="site-user">
                    <p>{% if user.avatar.url != "" %}<img alt="" src="{{ user.avatar.url }}" width="30" height="30"> {% endif %}</p>
                    <p> {{ user.username }}</p>
                </div>
                <p>{#<a class="userbtn" href="{% url 'compte' %}">Settings</a>#}
                    <a class="userbtn" href="{% url 'logout' %}"><span class="icon"><i
                            class="mdi mdi-logout"></i></span><span>Sign out</span></a></p>
                {% else %}
                <p><a class="userbtn" href="{% url 'login' %}"><span class="icon"><i
                        class="mdi mdi-login"></i></span><span>Sign in</span></a>
                    <a class="userbtn" href="{% url 'signup' %}"><span class="icon"><i class="mdi mdi-account-plus"></i></span><span>Sign up</span></a>
                </p>
                {% endif %}
            </div><!-- class="site-user" -->
            <ul class="site-nav-menu">
                <li class="site-nav-item menu-here"><a href="https://www.argawaen.net">Site Principal</a></li>
                <li class="site-nav-item menu-ayoaron"><a href="https://ayoaron.argawaen.net">Ayoaron</a></li>
                <li class="site-nav-item menu-testprojet"><a href="https://testsubject.argawaen.net">TestSubject</a>
                </li>
                {% if user.is_authenticated %}{% if user.has_Developper_Access %}
                <li class="site-nav-item menu-mantis"><a href="https://mantis.argawaen.net">bug Tracker</a></li>
                <li class="site-nav-item menu-tc"><a href="https://builder.argawaen.net">Builder</a></li>
                {% endif %}{% endif %}
            </ul>
        </div><!-- class="site-topright" -->
    </div><!-- class="upper-header" -->
    <div class="lower-header">
        <nav class="inner-nav">
            {%block innernav %}{% endblock %}
        </nav>
    </div><!-- class="lower-header" -->
</header><!-- class="site-header" -->
<div class="PageCenter"> <!-- conteneur global du contenu du site -->
    <div class="PageContent">
        {% block content %}
        <div id="container" style="width: 100%;">
          <canvas id="line-chart" style="display: block;width: 100%;height: 708px;"></canvas>
        </div>
        <div class="graphpilot">
            <form action="{% url 'index' %}" method="post">
                {% csrf_token %}
                <label for="i_last">Period</label>
                <select id="i_last" name="i_last">
                    <option value = "day" {% if last == "day" %}selected{% endif %}>Current day</option>
                    <option value = "3days" {% if last == "3days" %}selected{% endif %}>Three last days</option>
                    <option value = "week" {% if last == "week" %}selected{% endif %}>Current week</option>
                    <option value = "month" {% if last == "month" %}selected{% endif %}>Current Month</option>
                    <option value = "year" {% if last == "year" %}selected{% endif %}>Current Year</option>
                    <option value = "all" {% if last == "all" %}selected{% endif %}>All Data</option>
                </select>
                <label for="i_smoothing">Smoothing</label>
                <input type="range" id="i_smoothing" value="{{ smoothing }}" name="i_smoothing" min="0" max="30" step="1">
                <input type="submit" value="Update Graph">
            </form>
        </div>
        <script>
    var config = {
      type: 'line',
      data: {
        labels: {{ dates|safe }},
        datasets: [{
          data: {{ temperatures|safe }},
          label: 'Temperature',
          fill: false,
          pointRadius: 0,
          lineTension: 0,
          backgroundColor: mycolor(1),
          borderColor: mycolor(1),
          yAxisID: 'y-axis-1',
        }, {
          data: {{ humidity|safe }},
          label: 'Humidity',
          fill: false,
          pointRadius: 0,
          lineTension: 0,
          backgroundColor: mycolor(2),
          borderColor: mycolor(2),
          yAxisID: 'y-axis-2',
        }],
      },
      options: {
        responsive: true,
        title: {
            display: true,
            text: 'Temperature charts',
        },
        tooltips: {
            mode: 'index',
            intersect: false,
        },
        hover: {
            mode: 'nearest',
            intersect: true
        },
        scales: {
            xAxes: [{
                type: 'time',
                distribution: 'series',
                offset: true,
                ticks: {
                    major: {
                        enabled: true,
                        fontStyle: 'bold'
                    },
                    source: 'data',
                    autoSkip: true,
                    autoSkipPadding: 75,
                    maxRotation: 0,
                    sampleSize: 100
                },
            }],
            yAxes: [{
                type: 'linear',
                display: true,
                position: 'left',
                id: 'y-axis-1',

                scaleLabel: {
                    display: true,
                    labelString: 'Temperature',
                    fontColor: mycolor(1),

                }
            }, {
                type: 'linear',
                display: true,
                position: 'right',
                id: 'y-axis-2',

                scaleLabel: {
                    display: true,
                    labelString: 'Humidity',
                    fontColor: mycolor(2),
                },
                // grid line settings
                gridLines: {
                    drawOnChartArea: false, // only want the grid lines for one axis to show up
                },
            }],
        }
      }
    };

    window.onload = function() {
      var ctx = document.getElementById('line-chart').getContext('2d');
      window.myLine = new Chart(ctx, config);
    };
    document.getElementById('update').addEventListener('click', function() {
        var type = document.getElementById('type').value;
        var dataset = chart.config.data.datasets[0];
        dataset.type = type;
        dataset.data = generateData();
        chart.update();
    });
        </script>
        {% endblock %}
    </div><!-- class="PageContent" -->
</div><!-- class="PageCenter" -->
<footer class="site-footer"> <!-- conteneur global du pied de page -->
    <div class="FooterContent">
        <p style="font-size:12px">&copy; Design by Argawaen, all rights reserved. The site design, the logo are trademarks and/or registered trademarks of Argawaen.</p>
    </div><!-- class="FooterContent" -->
</footer><!-- class="site-footer" -->
</body>
</html>
